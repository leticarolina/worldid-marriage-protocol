# ðŸ’ HumanBond Protocol â€” V2

On-chain marriage, yield, milestones & relationship-proof infrastructure.
A clean refactor of the ETHGlobal Buenos Aires 2025 hackaton project â€œmarriageDAOâ€.

## Table of Contents

1. [Introduction](#introduction)
2. [Smart Contracts](#smart-contracts)
3. [Refactoring from Hackathon to V2](#refactoring-from-hackaton-to-v2)
4. [Protocol Overview](#protocol-overview)
5. [Author](#written-and-refactored-by)

## Introduction

HumanBond allows two verified humans (via World ID) to form a cryptographically provable bond on-chain.

A marriage becomes:

- A legal-fiction on-chain registry entry, and
- A two-person DAO with shared treasury, shared yield, and a permanent relationship history.

With one proposal â†’ one acceptance â†’ a couple immediately receives:

- A dynamic Vow NFT
- Annual Milestone NFTs
- TIME token yield for each day spent together

The protocol handles everything autonomously: proposals, acceptance, yield, shared treasury, on-chain history, and divorce.

## Smart Contracts

### World Chain Mainnet

- **Human Bond (Core Engine)**: [0x6494daa4e693F748Eb0a16041ECfCEd51392bB13](https://worldscan.org/address/0x6494daa4e693F748Eb0a16041ECfCEd51392bB13)
- **Vow Dynamic Onchain NFT**: [0xa1650cc531c2780fb8c006f4b8d314018f7f9ac9](https://worldscan.org/address/0xa1650cc531c2780fb8c006f4b8d314018f7f9ac9)
- **Milestone Upgradeable NFT**: 
[0x0a2759241d0cb610e3e61db351813ddf8a52f14c](https://worldscan.org/address/0x0a2759241d0cb610e3e61db351813ddf8a52f14c)
- **TIME Token**:
[0x261f6d89491cbadff7813303363a514f4b226a82](https://worldscan.org/address/0x261f6d89491cbadff7813303363a514f4b226a82)

### Contract Responsibilities

**HumanBond.sol** â†’ Core logic: proposals, marriage activation, divorce, yield, milestones.

**VowNFT.sol** â†’ Dynamic metadata NFT minted once per partner at marriage.

**MilestoneNFT.sol** â†’ Upgradeable NFT collection that tracks yearly anniversaries.

**TimeToken.sol** â†’ ERC-20 reward token generated by shared time in marriage.

## Protocol Overview

Core Lifecycle and Main Functions:

**1. Proposal**

> propose(address proposed, root, nullifier, proof)

- World ID verification
- Stores an outgoing proposal;
- Adds proposer to the recipientâ€™s incoming list;
- Prevents spam & multi-proposals;
- Prevents marriage if either address is already married;
- Only one-time nullifier use;

**2. Acceptance**

> accept(proposer, root, nullifier, proof)

- Creates a marriage with:
- Deterministic marriage ID
- Two dynamic Vow NFTs
- Initial TIME token reward (1 to each partner)
- All proposals cleared
- Activates marriage;

**3. Daily Yield**

Couples earn:
1 TIME token per day together (shared reward).

> claimYield(partner)

Splits the accumulated TIME tokens 50/50

**4. Milestones (â€œMemoriesâ€)**

> manualCheckAndMint(partner)

- Mints yearly anniversary NFT(s)
- Supports minting â€œmissed yearsâ€ in one call
- Uses MilestoneNFT to determine available years

**5. Divorce**

> divorce(partner)

- Auto-mints pending yield
- Marks marriage inactive
- Frees both partners to remarry
- Deletes no historical data (preserves relationship-proof)

## Refactoring from Hackaton to v2

V2 is a ground-up improvement aimed at reliability, gas-efficiency, and frontend simplicity

### Clean architecture

- Efficient incoming proposal indexing
- Efficient outgoing proposal tracking
- O(1) storage removal of proposals
- Deterministic marriage ID for easy lookups
- Proposal cancellation
- Deterministic marriage IDs upon marriage
- Direct UI-ready getter functions

### NFT & Token Logic Upgrades

- Dynamic Vow NFT metadata
- Milestone NFT with upgradeable registry of years
- Catch-up minting for anniversaries

### World ID Integration

- Separate external nullifiers for proposing & accepting
- Anti-replay nullifier tracking per action

## Written and refactored by

Leticia Azevedo: Smart Contracts Developer (Brazil)
